<div class="max-w-md mx-auto bg-white border rounded-xl p-5">
  <h2 class="text-lg font-semibold">Login GTD_Neto</h2>
  <p class="text-sm text-slate-600 mt-1">Accede con tu usuario de Supabase.</p>

  <% if (message) { %>
    <div class="mt-3 px-3 py-2 rounded-lg border border-blue-200 bg-blue-50 text-sm text-blue-700"><%= message %></div>
  <% } %>

  <form method="POST" action="/auth/login" class="mt-4 space-y-3" id="loginForm">
    <input type="hidden" name="_csrf" value="<%= csrfToken %>" />
    <div>
      <label class="text-xs text-slate-500 dark:text-slate-400">Email</label>
      <input type="email" name="email" required class="w-full border dark:border-slate-700 dark:bg-slate-800 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500" />
    </div>
    <div>
      <label class="text-xs text-slate-500 dark:text-slate-400">Contraseña</label>
      <input type="password" name="password" required minlength="6" class="w-full border dark:border-slate-700 dark:bg-slate-800 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500" />
    </div>
    <button type="submit" id="loginBtn" class="w-full rounded-lg bg-blue-600 text-white px-4 py-2 hover:bg-blue-700 transition-colors">Entrar</button>
  </form>

  <script>
    document.getElementById('loginForm')?.addEventListener('submit', function(e) {
      const btn = document.getElementById('loginBtn');
      LoadingManager.show(btn);
    });

    setupFormValidation('loginForm', {
      email: {
        required: true,
        email: true,
        requiredMessage: 'El email es requerido',
        emailMessage: 'Por favor ingresa un email válido'
      },
      password: {
        required: true,
        minLength: 6,
        requiredMessage: 'La contraseña es requerida',
        minLengthMessage: 'La contraseña debe tener al menos 6 caracteres'
      }
    });
  </script>

  <form method="POST" action="/auth/forgot" class="mt-4 pt-4 border-t space-y-2">
    <input type="hidden" name="_csrf" value="<%= csrfToken %>" />
    <div class="text-xs text-slate-500">¿Olvidaste tu contraseña?</div>
    <input type="email" name="email" placeholder="Tu correo" required class="w-full border rounded-lg px-3 py-2 text-sm" />
    <button class="w-full rounded-lg border bg-white px-4 py-2 text-sm hover:bg-slate-50">Enviar recuperación</button>
  </form>

  <div class="mt-4 text-sm text-slate-600">
    ¿No tienes cuenta?
    <a href="/signup" class="text-blue-600 hover:underline">Regístrate</a>
  </div>
</div>
