<div class="mb-6">
  <h2 class="text-lg font-semibold">ğŸ“Š EstadÃ­sticas de Productividad</h2>
  <p class="text-sm text-slate-600 mt-1">Resumen de tu actividad y progreso</p>
</div>

<!-- MÃ©tricas principales -->
<div class="grid grid-cols-2 md:grid-cols-4 gap-3 mb-6">
  <div class="bg-white border rounded-xl p-4">
    <div class="text-xs text-slate-600">Total Items</div>
    <div class="text-2xl font-bold mt-1"><%= stats.total %></div>
  </div>
  <div class="bg-white border rounded-xl p-4">
    <div class="text-xs text-slate-600">Activos</div>
    <div class="text-2xl font-bold mt-1 text-blue-600"><%= stats.active %></div>
  </div>
  <div class="bg-white border rounded-xl p-4">
    <div class="text-xs text-slate-600">Completados</div>
    <div class="text-2xl font-bold mt-1 text-emerald-600"><%= stats.completed %></div>
  </div>
  <div class="bg-white border rounded-xl p-4">
    <div class="text-xs text-slate-600">Promedio/dÃ­a</div>
    <div class="text-2xl font-bold mt-1 text-amber-600"><%= avgPerDay %></div>
  </div>
</div>

<!-- Completados por perÃ­odo -->
<div class="bg-white border rounded-xl p-5 mb-6">
  <h3 class="text-base font-semibold mb-4">âœ… Items Completados</h3>
  <div class="grid grid-cols-3 gap-4">
    <div class="text-center">
      <div class="text-3xl font-bold text-emerald-600"><%= stats.completedToday %></div>
      <div class="text-xs text-slate-600 mt-1">Hoy</div>
    </div>
    <div class="text-center">
      <div class="text-3xl font-bold text-emerald-600"><%= stats.completedWeek %></div>
      <div class="text-xs text-slate-600 mt-1">Esta semana</div>
    </div>
    <div class="text-center">
      <div class="text-3xl font-bold text-emerald-600"><%= stats.completedMonth %></div>
      <div class="text-xs text-slate-600 mt-1">Este mes</div>
    </div>
  </div>
</div>

<!-- GrÃ¡fico de Ãºltimos 7 dÃ­as -->
<div class="bg-white border rounded-xl p-5 mb-6">
  <h3 class="text-base font-semibold mb-4">ğŸ“ˆ Actividad (Ãšltimos 7 dÃ­as)</h3>
  <div class="flex items-end justify-between gap-2 h-40">
    <% last7Days.forEach(day => {
      const percentage = maxCount > 0 ? (day.count / maxCount) * 100 : 0;
      const barHeight = Math.max(day.count > 0 ? 12 : 2, percentage);
      const y = Math.max(0, 100 - barHeight);
    %>
      <div class="flex-1 flex flex-col items-center gap-2">
        <svg viewBox="0 0 100 100" class="w-full h-28" aria-hidden="true">
          <rect x="20" y="<%= y %>" width="60" height="<%= barHeight %>" rx="4" class="fill-blue-200"></rect>
          <% if (day.count > 0) { %>
            <text x="50" y="<%= Math.max(14, y + 12) %>" text-anchor="middle" class="fill-blue-900 text-[10px] font-semibold"><%= day.count %></text>
          <% } %>
        </svg>
        <div class="text-[10px] text-slate-600 text-center"><%= day.date %></div>
      </div>
    <% }); %>
  </div>
</div>

<!-- Items por lista -->
<div class="bg-white border rounded-xl p-5">
  <h3 class="text-base font-semibold mb-4">ğŸ“‹ DistribuciÃ³n por Lista</h3>
  <div class="space-y-3">
    <%
      const listLabels = {
        'collect': 'ğŸ“¥ Collect',
        'hacer': 'âœ… Hacer',
        'agendar': 'ğŸ“… Agendar',
        'delegar': 'ğŸ¤ Delegar',
        'desglosar': 'ğŸ”¨ Desglosar',
        'no-hacer': 'ğŸš« No hacer',
      };

      const maxListCount = Math.max(...Object.values(byList), 1);

      Object.keys(byList).forEach(listKey => {
        const count = byList[listKey];
        const percentage = (count / maxListCount) * 100;
    %>
      <div>
        <div class="flex items-center justify-between text-sm mb-1">
          <span class="dark:text-slate-100"><%= listLabels[listKey] || listKey %></span>
          <span class="font-semibold"><%= count %></span>
        </div>
        <progress class="w-full h-2 rounded [&::-webkit-progress-bar]:rounded [&::-webkit-progress-value]:rounded [&::-moz-progress-bar]:rounded [&::-webkit-progress-bar]:bg-slate-200 [&::-webkit-progress-value]:bg-blue-600[&::-webkit-progress-bar]:bg-slate-700[&::-webkit-progress-value]:bg-blue-500[&::-moz-progress-bar]:bg-blue-500" max="100" value="<%= Math.max(0, Math.min(100, Math.round(percentage))) %>"></progress>
      </div>
    <% }); %>
  </div>
</div>

<!-- Botones de acciÃ³n -->
<div class="mt-6 flex flex-wrap gap-2">
  <a href="/" class="px-4 py-2 rounded-lg border bg-white hover:bg-slate-50 transition-colors text-sm">
    â† Volver al Dashboard
  </a>
  <a href="/export" class="px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors text-sm">
    ğŸ“¥ Exportar Datos
  </a>
</div>
